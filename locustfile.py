"""
Load test the app using Locust.
NOTE: You can disable caching for testing via DISABLE_CACHE environment variable.

To install (assuming Python and virtualenv are installed):

virtualenv ~/venv/language_map
source ~/venv/language_map/bin/activate
pip install locustio

To run:

locust --host=http://localhost:4000
"""
from locust import HttpLocust, TaskSet, task


class MapTasks(TaskSet):
    """
    Simulate main map tasks of requesting geometries and speakers for states and PUMAs
    """
    @task
    def all_states(self):
        """
        Simulate request off all of continental US
        """
        self.client.get("/api/speakers/?boundingBox=-134.08,21.86,-57.39,51.56&language=1134&level=state&zoomLevel=5&age=0,97")
        self.client.get("/api/geojson/?level=state&ids=01,04,05,06,08,09,10,11,12,13,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,44,45,46,47,48,49,50,51,53,54,55,56")

    @task
    def southeastern_pa(self):
        """
        Simulate PUMA request with many PUMAs
        """
        self.client.get("/api/speakers/?boundingBox=-77.85,39.21,-73.06,41.02&language=1134&level=puma&zoomLevel=9&age=0,97")
        self.client.get("/api/geojson/?level=puma&ids=3604006,2400200,3604106,3401104,2400902,3402104,4203204,4203106,3603107,3604015,3603702,3604105,4203102,3401504,4203003,0900102,3603105,3401503,3604004,3604113,3400301,3401001,2400501,3603801,3603806,3603807,4203210,2400802,3401205,3604112,3603803,3603805,2401300,4203401,4203105,3401600,3604101,4201100,2400504,4203209,4203302,3402302,4203301,2401201,5110703,2400301,3402202,4203304,3603809,3603201,3401002,4203602,4203404,4203601,3400306,1000102,4200600,2400502,3603808,1000101,1000103,1000104,1000200,2400302,2400400,2400503,2400505,2400506,2400507,2400601,2400602,2400700,2400801,2400803,2400804,2400805,2400901,2401001,2401002,2401202,3400101,3400102,3400302,3400303,3400304,3400305,3400307,3400308,3400400,3400501,3400502,3400503,3400601,3400602,3400701,3400702,3400703,3400800,3400901,3400902,3400903,3400904,3400905,3400906,3400907,3401003,3401101,3401102,3401103,3401105,3401106,3401201,3401202,3401203,3401204,3401301,3401302,3401401,3401402,3401403,3401404,3401501,3401502,3401700,3401800,3401901,3401902,3401903,3401904,3402001,3402002,3402003,3402101,3402102,3402103,3402201,3402301,3402303,3402400,3402500,3402600,3603002,3603104,3603106,3603202,3603203,3603204,3603205,3603206,3603207,3603208,3603209,3603210,3603211,3603212,3603301,3603302,3603303,3603304,3603306,3603308,3603309,3603310,3603311,3603312,3603313,3603701,3603703,3603704,3603705,3603706,3603707,3603708,3603709,3603710,3603802,3603804,3603810,3603901,3603902,3603903,3604001,3604002,3604003,3604005,3604007,3604008,3604009,3604010,3604011,3604012,3604013,3604014,3604016,3604017,3604018,3604102,3604103,3604104,3604107,3604108,3604109,3604110,3604111,3604114,4200801,4200802,4200803,4200900,4201000,4201200,4202200,4202301,4202302,4202401,4202402,4202500,4202600,4202701,4202702,4202703,4202801,4202802,4202803,4202901,4202902,4203001,4203002,4203004,4203101,4203103,4203104,4203201,4203202,4203203,4203205,4203206,4203207,4203208,4203211,4203303,4203402,4203403,4203501,4203502,4203503,4203504,4203603,4203701,4203702,5400400")

class MapUser(HttpLocust):
    task_set = MapTasks
    min_wait = 5000
    max_wait = 15000
